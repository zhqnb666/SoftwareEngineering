# 个人记账本系统

一款基于 PySide6 + SQLite 的个人记账本系统，支持多账户管理、收支记录、数据查询统计、CSV 导入导出功能。

## 功能特色

- **多账户管理**: 支持创建多个账户，用于区分不同账本用途
- **收支记录**: 支持添加收入和支出条目，包含日期、金额、分类、备注等信息
- **分类管理**: 内置二级分类体系，支持收入和支出分类
- **数据查询**: 多维度查询条件，包含时间范围、类型、分类筛选
- **统计汇总**: 实时统计总收入、总支出、余额、条目数量
- **CSV 导入**: 支持从 CSV 文件批量导入数据，带格式验证
- **CSV 导出**: 支持将数据导出为 CSV 格式，便于备份和分析
- **友好界面**: 基于 PySide6 的现代化用户界面

## 系统要求

- Python 3.8 或更高版本
- PySide6 6.0.0 或更高版本
- SQLite3（Python 内置）

## 安装说明

1. 克隆或下载项目到本地
2. 安装依赖包：
   ```bash
   pip install -r requirements.txt
   ```

## 运行方法

在项目根目录下运行：
```bash
python main.py
```

## 项目结构

```
accounting_system/
├── main.py                   # 程序入口
├── requirements.txt          # 依赖包
├── README.md                 # 项目说明
│
├── core/                     # 核心业务逻辑
│   ├── __init__.py
│   ├── database.py          # 数据库管理
│   ├── models.py            # 数据模型
│   ├── profile_manager.py   # 账户管理
│   ├── entry_manager.py     # 条目管理
│   ├── category_manager.py  # 分类管理
│   ├── importer.py          # CSV导入
│   └── exporter.py          # CSV导出
│
├── ui/                       # 界面层
│   ├── __init__.py
│   ├── main_window.py       # 主窗口
│   ├── widgets/             # 自定义控件
│   │   ├── profile_selector.py    # 账户选择器
│   │   ├── entry_form.py          # 条目表单
│   │   ├── query_panel.py         # 查询面板
│   │   ├── statistics_panel.py    # 统计面板
│   │   └── entry_table.py         # 条目表格
│   └── dialogs/             # 对话框
│       ├── profile_dialog.py      # 新建账户对话框
│       └── import_dialog.py       # 导入对话框
│
└── data/                     # 数据目录
    └── accounting.db        # SQLite数据库（自动创建）
```

## 使用说明

### 1. 账户管理
- 系统首次运行会自动创建默认账户
- 可以通过"新建账户"按钮创建多个账户
- 使用下拉菜单切换当前账户
- 删除账户会同时删除该账户下的所有条目

### 2. 添加条目
- 在左侧表单中填写条目信息
- 必填项：日期、类型、金额、一级分类
- 可选项：二级分类、备注
- 点击"添加条目"保存

### 3. 查询筛选
- 设置时间范围（开始日期、结束日期）
- 选择条目类型（全部、收入、支出）
- 选择分类筛选
- 点击"查询"应用筛选条件

### 4. 数据导入导出
- **导出CSV**: 点击"导出CSV"将当前查询结果导出
- **导入CSV**: 点击"导入CSV"弹出导入对话框
- **下载模板**: 在导入对话框中可下载 CSV 模板文件

### 5. CSV 文件格式

导入的 CSV 文件必须包含以下表头：
```csv
日期,类型,金额,一级分类,二级分类,备注
2025-01-15,支出,35.50,餐饮,午餐,公司食堂
2025-01-16,收入,5000.00,工资,,月薪
```

**格式说明**：
- 日期：YYYY-MM-DD 格式
- 类型：仅允许"收入"或"支出"
- 金额：非负数字
- 一级分类：必填
- 二级分类：可为空
- 备注：可为空

## 默认分类

### 收入分类
- 工资
- 奖金
- 红包
- 投资收益
- 其他

### 支出分类
- **餐饮**: 早餐、午餐、晚餐、零食
- **交通**: 公交、地铁、打车、加油
- **购物**: 服饰、日用品、电子产品
- **娱乐**: 电影、游戏、旅游
- **医疗**: 药品、门诊、体检
- **教育**: 书籍、课程、培训
- **住房**: 房租、水电、物业
- **其他**

## 注意事项

1. 数据库文件会自动创建在 `data/accounting.db`
2. 请定期备份数据库文件
3. CSV 文件编码请使用 UTF-8
4. 删除操作不可撤销，请谨慎操作
5. 建议定期导出 CSV 文件作为数据备份

## 技术架构

- **界面框架**: PySide6 (Qt for Python)
- **数据库**: SQLite3
- **架构模式**: 分层架构（数据层 -> 业务逻辑层 -> 界面层）
- **数据模型**: 使用 dataclass 定义
- **异步处理**: QThread 处理耗时操作
